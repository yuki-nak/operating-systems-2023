ファイルシステムとは？
    ファイルシステムとはOSが補助記憶装置にあるファイルを管理する機能である。補助記憶装置は一般的にパーティションと呼ばれる区画を作成して使用されるため、ファイルシステムもまたパーティション上に作成される。また複数の物理的な補助記憶装置をストレージプールとして統合的に扱うこともできる。その場合、1つのパーティションのサイズは物理的な補助記憶装置のサイズを超えることができる。パーティション上でそれぞれファイルを保存する領域が割り当てられ、ファイルとディレクトリ情報、関連情報が保存される。即ちパーティションは論理的な補助記憶装置とみなすことができる。多くの場合、パーティション上に作成された記憶のためのデータ構造もファイルシステムと呼び、この作成を論理フォーマットと呼ぶ。ファイルシステム作成時は管理領域を確保するため、論理容量は物理容量に比べてやや減少する。

ファイルとは？
    ファイルとはデータやプログラムを格納する論理的な単位で、ファイル名や所有者など複数の属性を持つ。ファイル名に許容される文字はここのファイルシステムによって異なるが、Unicodeに含まれる各国も文字が使用できる場合が多い。またmain.cのようにピリオドで区切られた後ろの部分を拡張子（file name extension）という。ただし現代のOSでは拡張子は単なるファイル名の一部で、その扱いは個々のアプリケーションプログラムに委ねられている。

OS上どのようにファイル操作をおこなうか？
    アプリケーションプログラムやプロセスからファイルを操作するにはシステムコールを利用する。OPENを実行するとディレクトリからファイルの管理情報を検索し、OSの管理するファイルテーブルにエントリを追加し、ファイルハンドルとして以降の操作に利用する。そして現在の位置を0にセットする。CLOSEを実行するとファイル操作を終了する。またプロセス終了時は自動的にファイルは閉じられる。ファイルを一度に開く数はプロセスまたはOS単位で制限される。Linuxなど多くのシステムでは初期値上限は1024に設定されている。これは歩ァイルディスクリプタと呼ばれる整数番号によって管理されている。READを実行すると現在の位置から指定されたバイト数だけプロセスのアドレス空間内に指定された領域に読み出す。ファイル操作においてOSが補助記憶装置を読み書きするときはブロックを単位とする。

メモリマップトファイルとは？
    メモリマップトファイルとはページング機構を用いてプロセスの仮想アドレス空間内の領域に指定したファイルをマップする機能であり、READやWRITEなどのシステムコールを使わずメモリとファイルの読み書きをおこなう手法である。共有メモリと呼ばれる場合もある。メモリマップトファイルによりI/Oのパフォーマンスは向上する一方でブロックとページの割り付け単位の違いによりフラグメンテーションが発生する。

補助記憶装置へのアクセス方法は？
    主要なアクセス方法は2種類ある。

    (1) 順アクセス
        ファイルの先頭から末尾に向かってアクセス。指定された量だけスキップまたは先頭に戻すことは可能。テープのような線状の記憶媒体の場合に利用される。

    (2) 直接アクセス
        ディスク装置やSSDのような媒体で利用。順アクセスより自由度が高く効率的。

ディレクトリとは何か？
    ディレクトリとはファイルの名前や管理情報を格納し、ファイルの種類。フォルダとも呼ばれる。ディレクトリを複数作ることでツリー構造をとることが可能となる。ファイルをOPENする際は先にディレクトリを探索する必要がある。

ファイルはどのように保護されるか？
    コンピュータシステムには様々なオブジェクトが存在し、ファイルとディレクトリもまたオブジェクトである。これらオブジェクトのアクセスを保護するためアクセス制御と呼ぶ。アクセスする側を抽象化したものを保護ドメイン、または単にドメインと呼ぶ。アクセス制御は表形式で表現することが多く、その場合行を保護ドメイン、列をオブジェクトとし、要素を権限とする行列となる。

ファイルシステムはどのように実装するか？
    実装には補助記憶装置上のブロックにファイルを格納する必要がある。格納方法は以下のとおりである。
    (1) 連続割付け
        ファイルを補助記憶装置上の連続したブロックに隙間なく格納する方法を連続割付け（continuous allocation）という。連続割付けはファイルが格納されている場所のインデックスとしてディレクトリに先頭のブロック番号をつけるだけで実装が簡単である。さらにアクセス性能もよく、直接アクセスの場合でも効率的に処理が可能である。重大な欠点としてはファイルが肥大化し、次のブロックのデータを上書きしないよう、ファイル生成時にそのファイルの最大サイズを決定しなければならない。またファイルが削除されて空き領域ができ、再利用する場合でも前後のブロックが既に使用済みの場合はサイズは拡張できずフラグメンテーションが発生する。
    
    (2) 連結リスト割付け
        連結リスト割付けはブロック内に別のブロックを指すポインタを持たせ連結リストを用いてファイルを格納する方法である。連続割付け同様、ファイルが格納されている場所としてディレクトリに先頭のブロックを記録するだけなので実装が容易である。また連結割付けの課題であった予めファイルサイズを予測する必要はない。しかしながら記憶領域は分散するためアクセス効率が悪く、特に直接アクセスの効率がきわめて悪い。またリンク情報がすべてのブロックに保存されることでポインタが破損するリスクが高く、破損したポインタの後続データは全てアクセス不可となる。

    (3) 連結リストの索引を用いた割付け
        連結リスト割付けにおいてブロックに格納されたポインタのリンク情報を取り出して別に索引として補助記憶装置上におく方法である。この索引はFAT(File Allocation Table)というファイルシステム名でUSBメモリ等のファイル格納方法として用いられる。索引が決められた場所にあるためメモリにキャッシュされていれば補助記憶装置を逐次参照する必要がない。問題点はメモリや補助記憶装置のキャッシュが効かないと頻繁な補助記憶装置へのアクセスが発生するため大容量ファイルではパフォーマンスが悪い。

    (4) 索引ブロックを用いた割付け
        (3)と同じく索引を用いるが索引事態を専用のブロック（index block）としてファイル本体と同じ補助記憶装置上の領域に置く方法である。索引ブロックにはファイルを格納するデータブロック順にそのブロック番号を格納する。索引ブロックの容量を使い切る場合は別の索引ブロックを作成しポインタを持たせてアクセスすることの可能である。また索引ブロックの内部を高いそうかすることで対応する方法もある。

ディレクトリはどのように実装するか？
    ディレクトリの実装においてはファイルの所有者、タイムスタンプ、ファイルサイズなどのファイル管理情報の格納が課題となる。そこで解決策として２つの方法がある。１つはディレクトリに直接それらの属性をおく方法。もう一つはUNIXのiノードのようにファイル側で持たせる方法である。後者ではディレクトリはファイル名とiノード番号を格納するだけでよい。

ジャーナリングファイルシステムとは？
    ファイルデータの書込み中に不正が生じた際、素早く復旧できるようファイルシステムへの書込みをトランザクション単位とし、変更内容をメタデータとして保有する機能を持つシステム。Linuxのext3、ext4、XFSなどで使用されている。ジャーナリングシステムではデータブロックとは別に補助記憶装置上にジャーナルと呼ばれる変更情報を保存する領域を用意し、データブロックやディレクトリの書込みより先行しておこなう。書込みが終了した場合、ジャーナル情報は削除され残ることはない。ただしジャーナリングファイルシステムもファイルシステムを不整合のない状態に復元できてもファイルデータの中身までは復元できない場合があるので注意が必要である。

ログ構造ファイルシステムとは？
    データブロックやメタデータをログという単位でシーケンシャルに追記する方式。ログはデータサイズが時間とともに増加するため一定の間隔でファイル削除や上書きで無効となったブロックを整理する必要がある。そこでクリーナと呼ばれる別プロセスを使い、ログが使用している不要なブロックを回収し、有効なブロックを詰め合わせ、空きセグメントを増やすことをしている。

ストレージプールとは？
    複数の物理的な補助記憶装置をまとめてプールと呼ばれる1つの論理的な補助記憶装置を構成する技術。これによりシステムを稼働したまま個々の物理的な補助記憶装置の取り外しや装着（ホットスペア）が可能となる。またストレージプールによって異なるサイズやタイプの物理的な補助記憶装置を混在させたり、ZFSというファイルシステムのように頻繁にアクセスするデータはSSDに。それ以外はHDDといった構成をとることができる。

RAIDとは？
    RAID（Redundant arrays of independent disks）もまた複数の補助記憶装置（ドライブ）を組み合わせて１つのドライブとして運用する技術である。RAIDはレベルによってその特性が異なる。

    (1) RAID 0
        データを分割して保存する（ストライピング）。並列化がされるため2台の場合は2倍速になるが冗長性はない。最低2台のドライブから可能。

    (2) RAID 1
        複数台のドライブに同じ内容を格納する（ミラーリング）。2台の場合は1台が壊れても運用可能。パフォーマンスは特に改善されない。

    (3) RAID 5
        データを分割して1台分の誤り訂正符号（パリティビット）を分散して格納する技術。1TB x 3本の場合は2TBまでデータ利用可能。1TB x 4本の場合は3TBまで利用可能。

    (4) RAID 6
        RAID 5の冗長性をさらに高め2台分パリティビットを分散格納する方法。1TB x 4本の場合は2TBまでデータ利用可能。

    (5) RAID 10
        RAID 0のストライピングとRAID 1のミラーリングをセットで掛け合わせた構成。最低4台のドライブから可能。以降2本セットで追加をおこなう。
    
    (6) RAID 60
        RAID 6にRAID 0（ストライピング）を掛け合わせた方法。最低8台のドライブが必要。破損箇所によるが3台以上の破損でも修復可能。